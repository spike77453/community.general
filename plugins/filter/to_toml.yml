DOCUMENTATION:
  name: to_toml
  short_description: Converts a dictionary into TOML.
  version_added: 5.1.0
  description:
    - Converts a dictionary into a string containing the corresponding TOML-formatted data.
  options:
    _input:
      description: A dictionary
      type: dict
      required: true

EXAMPLES: |
  - name: Convert variable into toml file
    vars:
    - gitlab_runner_config:
        concurrent: 2
        check_interval: 2
        session_server:
          session_timeout: 1800
        runners:
          - name: "gitlab-runner.example.com"
            url: "https://gitlab.example.com"
            token: supersecrettoken
            executor: docker
            docker:
              tls_verify: true
              image: "fedora:latest"
              privileged: false
              disable_entrypoint_overwrite: false
              oom_kill_disable: false
              disable_cache: false
              volumes: ["/cache"]
              shm_size: 0
    ansible.builtin.copy:
      content: "{{ gitlab_runner_config | community.general.to_toml }}"
      dest: /etc/gitlab-runner/config.toml

  - name: Convert hostvars into toml file
    ansible.builtin.copy:
      content: "{{ hostvars['gitlab_runner']['runner_config'] | community.general.to_toml }}"
      dest: /etc/gitlab-runner/config.toml


RETURN:
  _value:
    description: A string containing TOML-formatted data.
    type: string
